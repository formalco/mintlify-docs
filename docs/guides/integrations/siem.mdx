---
title: "SIEM"
description: "Forward Formal logs to your SIEM, data lake, or observability platform"
icon: "pipe"
---

## Overview

Formal can forward all activity logs to your SIEM, data lake, or observability platform. This enables centralized log management, long-term retention, compliance reporting, and integration with your existing security tools.

## Supported Platforms

<img src="/assets/images/supported_logs.png" alt="Supported log destinations" />

- **AWS S3**
- **Datadog**
- **Splunk**
- **Elastic**
- **Sumo Logic**

<Note>
  By default, Formal forwards **all logs** to your configured destination.
</Note>

## Setup

### AWS S3

<Warning>
  AWS S3 log integration requires an [AWS Cloud Integration](/docs/guides/integrations/clouds) with S3 access enabled.
</Warning>

<Steps>
  <Step title="Set Up AWS Integration">
    First, configure an [AWS Cloud
    Integration](/docs/guides/integrations/clouds) with: -
**AllowS3Access**: `true` - **S3BucketARN**: Your S3 bucket ARN
  </Step>
  <Step title="Navigate to Log Integrations">
    Go to [Log Integrations](https://app.joinformal.com/log-integrations)
  </Step>
  <Step title="Create Integration">Click **Create Log Integration**</Step>
  <Step title="Select AWS S3">Choose AWS S3 as your provider</Step>
  <Step title="Configure">
    - **S3 Bucket Name**: Your bucket name - **Cloud Integration**: Select your
    AWS Cloud Integration
  </Step>
</Steps>

#### Terraform

```hcl
# First, create S3 bucket
resource "aws_s3_bucket" "formal_logs" {
  bucket = "formal-connector-logs"
}

# Create AWS Cloud Integration
resource "formal_integration_cloud" "aws" {
  name         = "aws-integration"
  cloud_region = "us-east-1"

  aws {
    template_version    = "1.2.0"
    allow_s3_access     = true
    s3_bucket_arn       = "${aws_s3_bucket.formal_logs.arn}/*"
  }
}

# Deploy CloudFormation stack (see AWS Integration guide)
resource "aws_cloudformation_stack" "formal" {
  # ... (see AWS Integration docs)
}

# Create log integration
resource "formal_integration_log" "s3" {
  name = "s3-log-drain"

  s3 {
    s3_bucket_name       = aws_s3_bucket.formal_logs.bucket
    cloud_integration_id = formal_integration_cloud.aws.id
  }
}
```

### Datadog

<Steps>
  <Step title="Get Datadog Credentials">
    From your Datadog account, retrieve: - Account ID - API Key - Site (e.g.,
    `datadoghq.com`, `datadoghq.eu`)
  </Step>
  <Step title="Navigate to Log Integrations">
    Go to [Log Integrations](https://app.joinformal.com/log-integrations)
  </Step>
  <Step title="Create Integration">Click **Create Log Integration**</Step>
  <Step title="Select Datadog">Choose Datadog as your provider</Step>
  <Step title="Enter Credentials">
    - **Account ID**: Your Datadog account ID - **API Key**: Your Datadog API
    key - **Site**: Your Datadog site
  </Step>
</Steps>

#### Terraform

```hcl
resource "formal_integration_log" "datadog" {
  name = "datadog-log-drain"

  datadog {
    account_id = var.datadog_account_id
    api_key    = var.datadog_api_key
    site       = "datadoghq.com"  # or datadoghq.eu, etc.
  }
}
```

### Splunk

<Steps>
  <Step title="Create Splunk HEC Token">
    In Splunk, create a new HTTP Event Collector (HEC) token
  </Step>
  <Step title="Navigate to Log Integrations">
    Go to [Log Integrations](https://app.joinformal.com/log-integrations)
  </Step>
  <Step title="Create Integration">Click **Create Log Integration**</Step>
  <Step title="Select Splunk">Choose Splunk as your provider</Step>
  <Step title="Enter Configuration">
    - **Access Token**: Your HEC token - **Host**: Your Splunk instance hostname
    - **Port**: HEC port (usually 8088)
  </Step>
</Steps>

#### Terraform

```hcl
resource "formal_integration_log" "splunk" {
  name = "splunk-log-drain"

  splunk {
    access_token = var.splunk_hec_token
    host         = "splunk.example.com"
    port         = 8088
  }
}
```

## Use Cases

### Compliance and Auditing

Forward logs to long-term storage for compliance requirements:

```hcl
# Archive to S3 for 7 years (SOC 2, HIPAA, etc.)
resource "formal_integration_log" "compliance_archive" {
  name = "compliance-s3-archive"

  s3 {
    s3_bucket_name       = aws_s3_bucket.compliance_logs.bucket
    cloud_integration_id = formal_integration_cloud.aws.id
  }
}

# Configure S3 lifecycle policy
resource "aws_s3_bucket_lifecycle_configuration" "compliance" {
  bucket = aws_s3_bucket.compliance_logs.id

  rule {
    id     = "archive-old-logs"
    status = "Enabled"

    transition {
      days          = 90
      storage_class = "GLACIER"
    }

    expiration {
      days = 2555  # 7 years
    }
  }
}
```

### Real-Time Security Monitoring

Send logs to your SIEM for real-time threat detection:

```hcl
# Send to Datadog for real-time monitoring
resource "formal_integration_log" "security_monitoring" {
  name = "datadog-security"

  datadog {
    account_id = var.datadog_account_id
    api_key    = var.datadog_api_key
    site       = "datadoghq.com"
  }
}
```

Create alerts in Datadog for:

- Failed authentication attempts
- Policy violations
- Unusual query patterns
- Off-hours access

### Data Lake Integration

Forward logs to your data lake for analytics:

```hcl
# Send to S3 data lake
resource "formal_integration_log" "data_lake" {
  name = "data-lake-integration"

  s3 {
    s3_bucket_name       = "my-data-lake-formal-logs"
    cloud_integration_id = formal_integration_cloud.aws.id
  }
}
```

Then use Athena, Redshift Spectrum, or Databricks to analyze:

- User access patterns
- Query performance
- Policy effectiveness
- Resource utilization

### Multi-Destination Forwarding

Send logs to multiple destinations:

```hcl
# Real-time monitoring
resource "formal_integration_log" "splunk_realtime" {
  name = "splunk-realtime"
  splunk {
    access_token = var.splunk_hec_token
    host         = "splunk.example.com"
    port         = 8088
  }
}

# Long-term archive
resource "formal_integration_log" "s3_archive" {
  name = "s3-archive"
  s3 {
    s3_bucket_name       = "formal-logs-archive"
    cloud_integration_id = formal_integration_cloud.aws.id
  }
}

# Security analytics
resource "formal_integration_log" "datadog_security" {
  name = "datadog-security"
  datadog {
    account_id = var.datadog_account_id
    api_key    = var.datadog_api_key
    site       = "datadoghq.com"
  }
}
```

## Next Steps

<CardGroup cols={2}>
  <Card
    title="AWS Integration"
    icon="aws"
    href="/docs/guides/integrations/clouds"
  >
    Set up AWS Cloud Integration for S3 logs
  </Card>
  <Card
    title="View Logs"
    icon="file-lines"
    href="/docs/guides/observability/logs"
  >
    Monitor logs in the Formal console
  </Card>
</CardGroup>
