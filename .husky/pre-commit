#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸš€ Running pre-commit checks on referenced files...\n"

# 1. Check spelling in referenced files only
echo "ğŸ“ Checking spelling..."
pnpm check-spelling
if [ $? -ne 0 ]; then
  echo "âŒ Commit aborted: Fix spelling errors"
  exit 1
fi

# 2. Check for broken links in referenced files only
echo "\nğŸ”— Checking for broken links..."
pnpm check-links
if [ $? -ne 0 ]; then
  echo "âŒ Commit aborted: Fix broken links before committing"
  exit 1
fi

# 3. Check for missing image assets in referenced files only
echo "\nğŸ–¼ï¸  Checking for missing image assets..."
pnpm check-assets
if [ $? -ne 0 ]; then
  echo "âŒ Commit aborted: Fix missing image references"
  exit 1
fi

# 4. Format check content folders (don't auto-fix, just verify)
echo "\nâœ¨ Checking code formatting..."
pnpm format-check
if [ $? -ne 0 ]; then
  echo "âŒ Commit aborted: Run 'pnpm format' to fix formatting"
  exit 1
fi

# 5. Check for unreferenced files (warning only, doesn't block)
echo "\nğŸ“‹ Checking for unreferenced files..."
pnpm check-unreferenced

echo "\nâœ… All pre-commit checks passed - proceeding with commit"
